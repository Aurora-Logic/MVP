/* ═══════════════════════════════════════════════
   FEATURES — Sections, Libraries, Empty States
   Save indicator, Expiry, Loading, Drag states
   ═══════════════════════════════════════════════ */

/* ════════ SECTIONS (Accordion) ════════ */

.sec-b {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--r2);
  margin-bottom: 10px;
  transition: border-color var(--t);
}
.sec-b:hover { border-color: var(--border-h); }
.sec-b.open { border-color: var(--border-h); }

.sec-hd {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 14px;
  cursor: pointer;
  transition: background var(--t);
}
.sec-hd:hover { background: var(--muted); }

.sec-grip {
  color: var(--text4);
  cursor: grab;
  display: flex;
  transition: color var(--t);
}
.sec-grip:hover { color: var(--text); }
.sec-grip svg { width: 14px; height: 14px; }

.sec-nm {
  flex: 1;
  font-size: 14px;
  font-weight: 600;
  color: var(--text);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.sec-chv {
  transition: transform var(--t2);
  color: var(--text4);
  display: flex;
}
.sec-chv svg { width: 14px; height: 14px; }
.sec-b:not(.open) .sec-chv { transform: rotate(-90deg); }

.sec-acts {
  display: flex;
  gap: 2px;
  opacity: 0.4;
  transition: opacity var(--t);
}
.sec-hd:hover .sec-acts { opacity: 1; }

.sec-bd {
  padding: 4px 14px 16px;
  display: none;
  border-top: 1px solid var(--border);
}
.sec-b.open .sec-bd { display: block; }

.sec-ti { margin-bottom: 8px; }

/* ════════ SECTION LIBRARY ════════ */

.lib-search { margin-bottom: 10px; }

.lib-cats {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  margin-bottom: 12px;
}
.lib-cat {
  padding: 4px 10px;
  font-size: 11px;
  font-weight: 500;
  font-family: var(--font);
  color: var(--text3);
  background: var(--muted);
  border: none;
  border-radius: var(--r-pill);
  cursor: pointer;
  transition: all var(--t);
}
.lib-cat:hover { color: var(--text); }
.lib-cat.active {
  background: var(--primary);
  color: var(--primary-foreground);
}

.lib-list {
  display: flex;
  flex-direction: column;
  gap: 2px;
  max-height: 400px;
  overflow-y: auto;
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.lib-list::-webkit-scrollbar { display: none; }
.lib-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 10px;
  border-radius: var(--r);
  cursor: pointer;
  transition: all var(--t);
}
.lib-item:hover { background: var(--muted); }
.lib-item svg { width: 14px; height: 14px; color: var(--text4); flex-shrink: 0; }
.lib-item-t {
  font-size: 13px;
  font-weight: 500;
  color: var(--text);
  flex: 1;
}
.lib-item-cat {
  font-size: 10px;
  font-weight: 600;
  padding: 2px 7px;
  border-radius: var(--r-pill);
  text-transform: capitalize;
}
.cat-intro { background: var(--blue-bg); color: var(--blue); }
.cat-scope { background: var(--green-bg); color: var(--green); }
.cat-terms { background: var(--amber-bg); color: var(--amber); }
.cat-pricing { background: var(--red-bg); color: var(--red); }
.cat-general { background: var(--muted); color: var(--text3); }
.cat-custom { background: var(--muted); color: var(--purple); }

.lib-item-d {
  font-size: 10px;
  color: var(--text4);
  white-space: nowrap;
}
.lib-empty {
  padding: 20px;
  text-align: center;
  font-size: 12px;
  color: var(--text4);
}

/* ════════ T&C LIBRARY ════════ */

.tc-tabs {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
  margin-bottom: 12px;
}
.tc-tab {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 5px 10px;
  font-size: 12px;
  font-weight: 500;
  font-family: var(--font);
  color: var(--text3);
  background: var(--muted);
  border: none;
  border-radius: var(--r-pill);
  cursor: pointer;
  transition: all var(--t);
}
.tc-tab:hover { color: var(--text); }
.tc-tab.active {
  background: var(--primary);
  color: var(--primary-foreground);
}
.tc-tab svg { width: 14px; height: 14px; }
.tc-count {
  font-size: 10px;
  font-weight: 600;
  opacity: 0.7;
}

.tc-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}
.tc-chip {
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: var(--r);
  cursor: pointer;
  transition: all var(--t);
}
.tc-chip:hover {
  border-color: var(--border-h);
  background: var(--muted);
}
.tc-chip-t {
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 3px;
}
.tc-chip-d {
  font-size: 11px;
  color: var(--text3);
  line-height: 1.4;
}

/* ════════ EMPTY STATES ════════ */

.empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 60px 20px;
}
.empty-icon {
  width: 48px;
  height: 48px;
  background: var(--muted);
  border-radius: var(--r3);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 14px;
}
.empty-icon svg { width: 20px; height: 20px; color: var(--text4); }
.empty-t {
  font-size: 15px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 4px;
}
.empty-d {
  font-size: 13px;
  color: var(--text3);
  max-width: 320px;
  line-height: 1.5;
  margin-bottom: 14px;
}

/* Compact empty state (editor tabs) */
.empty-sm {
  padding: 40px 20px;
}
.empty-sm .empty-icon {
  width: 40px;
  height: 40px;
  border-radius: 10px;
}
.empty-sm .empty-icon svg {
  width: 18px;
  height: 18px;
}
.empty-sm .empty-t {
  font-size: 14px;
}
.empty-sm .empty-d {
  font-size: 12px;
}

/* First run (dashboard) */
.first-run {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 60px 20px;
}
.fr-icon {
  width: 56px;
  height: 56px;
  background: var(--muted);
  border-radius: var(--r3);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 16px;
}
.fr-icon svg { width: 28px; height: 28px; color: var(--blue); }
.fr-title {
  font-size: 22px;
  font-weight: 800;
  color: var(--text);
  letter-spacing: -0.3px;
}
.fr-desc {
  font-size: 14px;
  color: var(--text3);
  max-width: 420px;
  line-height: 1.6;
  margin: 8px 0 20px;
}
.fr-actions {
  display: flex;
  gap: 10px;
  margin-bottom: 40px;
}
.fr-features {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  max-width: 500px;
}
.fr-feat { text-align: center; }
.fr-feat-icon {
  width: 40px;
  height: 40px;
  background: var(--muted);
  border-radius: var(--r2);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 8px;
}
.fr-feat-icon svg { width: 18px; height: 18px; color: var(--text3); }
.fr-feat-t {
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
}
.fr-feat-d {
  font-size: 11px;
  color: var(--text4);
  margin-top: 2px;
}

/* ════════ EXPIRY BANNERS ════════ */

.expiry-banner {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  border-radius: var(--r2);
  font-size: 13px;
  margin-bottom: 8px;
}
.expiry-banner svg { width: 16px; height: 16px; flex-shrink: 0; }
.expiry-text { flex: 1; }
.expiry-text strong { font-weight: 600; }

.expiry-banner.expired { background: var(--red-bg); color: var(--red); }
.expiry-banner.urgent { background: var(--red-bg); color: var(--red); }
.expiry-banner.warning { background: var(--amber-bg); color: var(--amber); }
.expiry-banner.info { background: var(--blue-bg); color: var(--blue); }

/* Expiry warnings (Details tab) */
.expiry-warn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  border-radius: var(--r2);
  font-size: 13px;
  margin-bottom: 14px;
}
.expiry-warn svg { width: 16px; height: 16px; flex-shrink: 0; }
.warn-expired { background: var(--red-bg); color: var(--red); }
.warn-soon { background: var(--amber-bg); color: var(--amber); }
.warn-ok { background: var(--green-bg); color: var(--green); }

/* ════════ ARCHIVED BADGE ════════ */

.badge-archived {
  background: var(--muted);
  color: var(--text4);
}

/* ════════ STRUCTURED SECTIONS ════════ */

.badge-sec-type {
  font-size: 10px;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: var(--r-pill);
  display: inline-flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}
.badge-sec-type svg { width: 11px; height: 11px; }
.badge-sec-type.testi { background: var(--blue-bg); color: var(--blue); }
.badge-sec-type.cs { background: var(--amber-bg); color: var(--amber); }

.testi-quote {
  resize: vertical;
  min-height: 60px;
}

.star-rating {
  display: flex;
  gap: 2px;
}
.star-btn {
  background: none;
  border: none;
  padding: 2px;
  cursor: pointer;
  color: var(--border);
  transition: color var(--t);
}
.star-btn svg { width: 18px; height: 18px; }
.star-btn.on { color: var(--amber); }
.star-btn.on svg { fill: var(--amber); stroke: var(--amber); }
.star-btn:hover { color: var(--amber); }

.sec-type-menu {
  position: absolute;
  right: 0;
  top: 100%;
  z-index: 100;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--r2);
  box-shadow: var(--sh3);
  padding: 4px;
  min-width: 160px;
}
.sec-type-opt {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  font-size: 13px;
  font-weight: 500;
  color: var(--text);
  border-radius: var(--r);
  cursor: pointer;
  transition: background var(--t);
}
.sec-type-opt:hover { background: var(--muted); }
.sec-type-opt svg { width: 14px; height: 14px; color: var(--text3); }

/* ════════ DRAG STATES ════════ */

.dragging {
  opacity: 0.5;
  box-shadow: var(--sh2);
  user-select: none;
}
.drag-over {
  border-top: 3px solid var(--blue) !important;
  background: rgba(37, 99, 235, 0.04);
}
.drag-over-bottom {
  border-bottom: 3px solid var(--blue) !important;
  background: rgba(37, 99, 235, 0.04);
}
.sec-b.dragging .sec-hd {
  background: transparent !important;
  transition: none;
}

/* ════════ LOADING OVERLAY ════════ */

.loading-overlay {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  z-index: 10000;
  background: rgba(255, 255, 255, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px);
  overflow: hidden;
}
.dark .loading-overlay {
  background: rgba(9, 9, 11, 0.7);
}
.loading-spinner {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  font-size: 14px;
  color: var(--text3);
}
.loading-spinner svg {
  width: 28px;
  height: 28px;
  color: var(--primary);
  animation: spin 1s linear infinite;
}

/* ════════ SKELETON SCREENS ════════ */

@keyframes skeleton-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}
.skeleton {
  background: var(--muted);
  border-radius: var(--r);
  animation: skeleton-pulse 1.5s ease-in-out infinite;
}
.skeleton-text {
  height: 12px;
  border-radius: 6px;
}
.skeleton-text.w-full { width: 100%; }
.skeleton-text.w-3-4 { width: 75%; }
.skeleton-text.w-1-2 { width: 50%; }
.skeleton-badge {
  height: 22px;
  width: 60px;
  border-radius: var(--r-pill);
}
.skeleton-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px 16px;
  border-bottom: 1px solid var(--border);
}

/* Editor fade-in */
.editor-loading { opacity: 0; }
.editor-loaded {
  opacity: 1;
  transition: opacity var(--t2);
}

/* ════════ SHORTCUTS PANEL ════════ */

.sc-list {
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.sc-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 0;
}
.sc-label {
  font-size: 13px;
  color: var(--text);
}
.sc-keys {
  display: flex;
  gap: 4px;
}

/* ════════ SHARE MODAL ════════ */

.share-link-row {
  display: flex;
  gap: 8px;
  align-items: center;
}
.share-link-row input {
  flex: 1;
}
.share-stats {
  background: var(--muted);
  padding: 12px;
  border-radius: var(--r);
  margin-bottom: 16px;
}

/* ════════ CSV IMPORT ════════ */

.csv-paste {
  font-family: var(--mono);
  font-size: 12px;
  resize: vertical;
  min-height: 80px;
}
.csv-map-select {
  font-size: 12px !important;
  padding: 4px 8px !important;
}

/* ════════ EMAIL MODAL ════════ */

.email-preview {
  background: var(--muted);
  border-radius: var(--r2);
  padding: 16px;
  font-size: 13px;
  line-height: 1.6;
  color: var(--text);
  max-height: 300px;
  overflow-y: auto;
}

/* ════════ SECTION PACKS ════════ */

.pack-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.pack-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--r3);
  padding: 16px;
  text-align: center;
  transition: all var(--t);
}

.pack-card:hover {
  transform: translateY(-1px);
  box-shadow: var(--sh2);
}

.pack-icon {
  width: 40px;
  height: 40px;
  border-radius: var(--r2);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 8px;
}

.pack-icon svg {
  width: 20px;
  height: 20px;
}

.pack-name {
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
}

.pack-desc {
  font-size: 11px;
  color: var(--text3);
  margin-top: 4px;
  line-height: 1.4;
}

.pack-count {
  font-size: 10px;
  font-weight: 600;
  color: var(--text4);
  text-transform: uppercase;
  letter-spacing: 0.3px;
  margin-top: 6px;
}

.pack-preview-item {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 8px 0;
  border-bottom: 1px solid var(--border);
}

.pack-preview-item:last-child {
  border-bottom: none;
}

.pack-preview-num {
  width: 22px;
  height: 22px;
  background: var(--muted);
  color: var(--text3);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  flex-shrink: 0;
  margin-top: 2px;
}

.pack-preview-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
}

.pack-preview-excerpt {
  font-size: 11px;
  color: var(--text4);
  margin-top: 2px;
  line-height: 1.4;
}

@media (max-width: 480px) {
  .pack-grid {
    grid-template-columns: 1fr;
  }
}

/* ════════ COMPLETENESS MODAL ════════ */

.comp-score-row {
  display: flex;
  align-items: center;
  gap: 12px;
  margin: 16px 0;
}

.comp-score-val {
  font-size: 32px;
  font-weight: 800;
}

.comp-progress-wrap {
  flex: 1;
  height: 6px;
  background: var(--muted);
  border-radius: 3px;
  overflow: hidden;
}

.comp-progress-fill {
  height: 100%;
  border-radius: 3px;
  transition: width .3s;
}

.comp-group-label {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .5px;
  color: var(--text4);
  margin: 10px 0 4px;
}

.comp-check-row {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 0;
  font-size: 13px;
}

.comp-check-icon {
  width: 15px;
  height: 15px;
}

.comp-check-label {
  flex: 1;
}

.comp-check-pts {
  font-size: 10px;
  font-weight: 600;
}

.comp-quick-wins {
  padding: 10px;
  background: var(--muted);
  border-radius: 8px;
  font-size: 12px;
  color: var(--text3);
}

.comp-quick-wins strong {
  color: var(--text);
}

.comp-all-good {
  padding: 10px;
  background: var(--green-bg);
  border-radius: 8px;
  font-size: 12px;
  color: var(--green);
  font-weight: 500;
}

.comp-checks-list {
  margin-bottom: 16px;
}

/* Score badge inline */
.score-badge {
  font-size: 10px;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: 9999px;
}

/* ════════ BREAKDOWN MODAL ════════ */

.breakdown-modal-body {
  width: 600px;
  max-height: 85vh;
  overflow-y: auto;
}

.breakdown-tabs {
  margin: 14px 0 16px;
}

.breakdown-empty {
  padding: 20px;
  text-align: center;
  color: var(--text4);
  font-size: 13px;
}

/* ════════ CSV IMPORT MODAL ════════ */

.csv-modal-body {
  width: 520px;
}

.csv-map-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
  margin-bottom: 12px;
}

.csv-map-label {
  font-size: 11px;
}

.csv-preview-header {
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 6px;
}

.csv-table-wrap {
  overflow-x: auto;
  max-height: 180px;
}

/* ════════ T&C LIBRARY SCROLL ════════ */

.tc-grid-scroll {
  max-height: 340px;
  overflow-y: auto;
}

/* ════════ SECTION LIBRARY SCROLL ════════ */

.lib-list-scroll {
  max-height: 280px;
  overflow-y: auto;
}

/* ════════ MODAL ICON HEADER ════════ */

.modal-t-icon {
  width: 18px;
  height: 18px;
  vertical-align: -3px;
  margin-right: 6px;
}

/* ════════ LIBRARY TABS BAR ════════ */

.lib-tabs-bar {
  display: flex;
  gap: 2px;
  background: var(--muted);
  padding: 2px;
  border-radius: 9999px;
  margin-bottom: 12px;
}

/* ════════ LIBRARY PACKS VIEW ════════ */

.lib-packs-view {
  max-height: 340px;
  overflow-y: auto;
}
